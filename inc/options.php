<?function oifrontendprofile_fields() //Создаём массив с данными опций плагина{	$fields = array(         		'post_id' => array(									'caption' => __('Profile page','oifrontendprofile'),									'title' => __('This page will be displayed when editing a profile','oifrontendprofile'),									'type' => 'select',									'hint' => __('This page MUST contain <b>[oi_frontend_profile]</b> shortcode','oifrontendprofile'),		),		'turn_off_css' => array(									'caption' => __('CSS','oifrontendprofile'),									'title' => __('Turn off plugin styles','oifrontendprofile'),									'type' => 'checkbox',									'hint' => __('If you want to use your own CSS or use Bootstrap(should be installed) CSS - check this option.','oifrontendprofile'),		),		'admin_bar_front_off' => array(									'caption' => __('Admin bar','oifrontendprofile'),									'title' => __('Hide','oifrontendprofile'),									'type' => 'checkbox',									'hint' => __('Hide the Admin bar from a frontend.','oifrontendprofile'),		),		'backend_hide' => array(									'caption' => __('Backend','oifrontendprofile'),									'title' => __('Redirect out of backend','oifrontendprofile'),									'type' => 'checkbox',									'hint' => __('Disallow users to go to the backend.','oifrontendprofile'),		),	);	return $fields;}// Добавляем новый пункт меню в админкуadd_action('admin_menu', 'oifrontendprofile_admin_page');//Создаём кнопку для перехода на странице настроек плагина в админке WPfunction oifrontendprofile_admin_page(){    add_options_page('oifrontendprofile', 'Oi Frontend Profile', 8, __FILE__, 'oifrontendprofile_options_page');}	function pr($s) {	print '<pre><code>';		print_r($s);	print '</code></pre>';}	function oifrontendprofile_options_page() {      //Функция создания и обработки страницы настроек плагина	global $wpdb;	$options = oifrontendprofile_fields();	if ($_POST['cmd'] == 'oifrontendprofile_save_opt')//Обработка нажатия "Сохранить настройки"	{		foreach ($options as $k=>$v)//Перебор массива с первичными данными		{			$oifrontendprofile[ $k ] = $_POST[ $k ]; //Каждому элементу массива присваиваем введённое пользователем занчение		}		$oifrontendprofile = json_encode( $oifrontendprofile );		//foreach ($options as $oifrontendprofile_opt)//Обновляем настройки плагина в таблице настроек wordpress		{			update_option('oifrontendprofile', $oifrontendprofile);		}     ?>         <div class="updated"><p><strong> <? echo __('Settings saved','oifrontendprofile'); ?></strong></p></div>     <?	}	$get_options = get_oifrontendprofile();	foreach( $options as $k=>$v) // перебор массива с настройками	{		$options[ $k ][ 'value' ] = $get_options[ $k ]; // присваиваем значение переменной с нормальным именем	}?>	<div class="wrap">		<h2><?=__('Oi Frontend Profile','oifrontendprofile')?></h2>		<h3><?=__('Settings','oifrontendprofile')?></h3>		<form method="post" action="<? echo $_SERVER['REQUEST_URI'];?>">			<table class="form-table">				<tr>					<th scope="row"><?=$options[ 'post_id' ][ 'caption' ]?></th>					<td>						<?						$args = array(							'child_of'		=> 0,							'sort_order'	=> 'ASC',							'sort_column'	=> 'post_title',							'hierarchical'	=> 1,							'name'			=> 'post_id',							'selected'		=> $options[ 'post_id' ][ 'value' ],							'post_type'		=> 'page'						);						wp_dropdown_pages( $args );						?>						<label for="turn_off_css"><?=$options[ 'post_id' ][ 'title' ]?></label>						<p class="help-block description"><?=$options[ 'post_id' ][ 'hint' ]?></p>					</td>				</tr>				<tr>					<th scope="row"><?=$options[ 'turn_off_css' ][ 'caption' ]?></th>					<td>						<?=oinput(array(							'key'=>		'turn_off_css',							'type'=>	$options[ 'turn_off_css' ][ 'type' ],							'value'=>	$options[ 'turn_off_css' ][ 'value' ],							'after'=>	$options[ 'turn_off_css' ][ 'title' ],							'hint'=>	$options[ 'turn_off_css' ][ 'hint' ],						))?>					</td>				</tr>				<tr>					<th scope="row"><?=$options[ 'admin_bar_front_off' ][ 'caption' ]?></th>					<td>						<?=oinput(array(							'key'=>		'admin_bar_front_off',							'type'=>	$options[ 'admin_bar_front_off' ][ 'type' ],							'value'=>	$options[ 'admin_bar_front_off' ][ 'value' ],							'after'=>	$options[ 'admin_bar_front_off' ][ 'title' ],							'hint'=>	$options[ 'admin_bar_front_off' ][ 'hint' ],						))?>					</td>				</tr>				<tr>					<th scope="row"><?=$options[ 'backend_hide' ][ 'caption' ]?></th>					<td>						<?=oinput(array(							'key'=>		'backend_hide',							'type'=>	$options[ 'backend_hide' ][ 'type' ],							'value'=>	$options[ 'backend_hide' ][ 'value' ],							'after'=>	$options[ 'backend_hide' ][ 'title' ],							'hint'=>	$options[ 'backend_hide' ][ 'hint' ],						))?>					</td>				</tr>			</table>			<input type="hidden" name="cmd" value="oifrontendprofile_save_opt">			<p class="submit"><input type="submit" name="Submit" value="<?php _e('Save Changes') ?>" /></p>		</form>	</div><?php//Конец функции создания и обработки страницы настроек.}?>